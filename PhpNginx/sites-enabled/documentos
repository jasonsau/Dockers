#map $http_upgrade $type {
#        default "web";
#        websocket "ws";
#}
#server {
#        listen 80;
#        listen [::]:80;
#        server_name rs.tevalida.com;
#        location / {
#                return 301 https://rs.tevalida.com$request_uri;
#        }
#}

server {
        server_name rs.tevalida.com;
        listen 80;
        listen [::]:80;

        root /var/www/html/ValidarDocumentos/public;

        add_header X-Frame-Options "SAMEORIGIN";
        add_header X-Content-Type-Options "nosniff";
        access_log /var/www/html/ValidarDocumentos/access_log;
        error_log /var/www/html/ValidarDocumentos/error_log;
        client_max_body_size 100M;

        index index.php;

        charset utf-8;

        location / {
            try_files $uri $uri/ /index.php?$query_string;
        }

#        location @ws{
#                proxy_pass http://localhost:6001;
#                proxy_set_header Host $host;
#                proxy_read_timeout 60;
#                proxy_connect_timeout 60;
#                proxy_redirect off;

#                proxy_http_version 1.1;
#                proxy_set_header Upgrade $http_upgrade;
#                proxy_set_header Connection 'upgrade';
#                proxy_set_header Host $host;
#                proxy_cache_bypass $http_upgrade;
#        }

        location = /favicon.ico { access_log off; log_not_found off; }
        location = /robots.txt { access_log off; log_not_found off; }

        error_page 404 /index.php;

        location ~ \.php$ {
                fastcgi_pass phpserver:9000;
                include fastcgi_params;
                fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;

        }

        location ~ /\.(?!well-known).* {
                deny all;
        }

        #ssl_certificate /etc/letsencrypt/live/rs.tevalida.com-0001/fullchain.pem;
        #ssl_certificate_key /etc/letsencrypt/live/rs.tevalida.com-0001/privkey.pem;
        #ssl_dhparam /etc/ssl/certs/invering/dh_rs.tevalida.4096.pem;
        #ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        #ssl_prefer_server_ciphers on;
        #ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH";
        #ssl_ecdh_curve secp384r1;
        #ssl_session_cache shared:SSL:10m;
        #ssl_session_tickets off;
        #ssl_stapling on;
        #ssl_stapling_verify on;
        #resolver 8.8.8.8 8.8.4.4 valid=300s;
        #resolver_timeout 5s;
        #add_header Strict-Transport-Security "max-age=63072000;includeSubdomains";
        #add_header X-Frame-Options SAMEORIGIN;
}